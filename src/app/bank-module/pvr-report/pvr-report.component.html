<div class="container-fluid pb-5">
  <!-- start page title -->
  <app-page-title
    title="Add PVR Report"
    [breadcrumbItems]="breadCrumbItems"
  ></app-page-title>
  <div class="card" *ngIf="!isLoading">
    <div class="card-body">
      <div class="row">
        <div class="col-12">
          <app-portlet
            loading="0"
            title="Application Information"
            color="light"
            collapsed="0"
            headerClass="title header-title "
            ><div class="row">
              <div class="col-md-4">
                <table class="table table-borderless hover">
                  <tr>
                    <th>Application Number</th>
                    <td>
                      {{
                        applicationData.ApplicationID
                          ? applicationData.ApplicationID
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Applicant Name</th>
                    <td>
                      {{
                        applicationData.FirstName && applicationData.LastName
                          ? applicationData.FirstName +
                            " " +
                            applicationData.LastName
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Email Address</th>
                    <td>
                      {{
                        applicationData.EmailAddress
                          ? applicationData.EmailAddress
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Mobile Number</th>
                    <td>
                      {{
                        applicationData.MobileNumber
                          ? applicationData.MobileNumber
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Application Status</th>
                    <td>
                      {{
                        applicationData.ApplicationStatus
                          ? applicationData.ApplicationStatus
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Bank Name</th>
                    <td>
                      {{
                        applicationData.BankName
                          ? applicationData.BankName
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Branch Name</th>
                    <td>
                      {{
                        applicationData.BranchCode
                          ? applicationData.BranchCode
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Loan Amount</th>
                    <td>
                      {{
                        applicationData.LoanAmount
                          ? applicationData.LoanAmount
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Type of Loan</th>
                    <td>
                      {{
                        applicationData.Type_of_Loan
                          ? applicationData.Type_of_Loan
                          : "-"
                      }}
                    </td>
                  </tr>
                </table>
              </div>
              <div class="col-md-4">
                <table class="table table-borderless hover">
                  <tr>
                    <th>District</th>
                    <td>
                      {{
                        applicationData.DistrictName
                          ? applicationData.DistrictName
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Taluka</th>
                    <td>
                      {{
                        applicationData.TalukaName
                          ? applicationData.TalukaName
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Village</th>
                    <td>
                      {{
                        applicationData.VillageName
                          ? applicationData.VillageName
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Survey No</th>
                    <td>
                      {{
                        applicationData.SurveyNo
                          ? applicationData.SurveyNo
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>City Survey No</th>
                    <td>
                      {{
                        applicationData.CitySurveyNumber
                          ? applicationData.CitySurveyNumber
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>FP No</th>
                    <td>
                      {{ applicationData.FPNo ? applicationData.FPNo : "-" }}
                    </td>
                  </tr>
                  <tr>
                    <th>TP No</th>
                    <td>
                      {{ applicationData.TPNo ? applicationData.TPNo : "-" }}
                    </td>
                  </tr>
                  <tr>
                    <th>Loan Property Type</th>
                    <td>
                      {{
                        applicationData.Loan_Property_Type
                          ? applicationData.Loan_Property_Type
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Postal Address</th>
                    <td>
                      {{
                        applicationData.PostalAddress
                          ? applicationData.PostalAddress
                          : "-"
                      }}
                    </td>
                  </tr>
                </table>
              </div>
              <div class="col-md-4">
                <table class="table table-borderless hover">
                  <tr>
                    <th>Is Owner Same</th>
                    <td>{{ applicationData.IsOwnerSame ? "Yes" : "No" }}</td>
                  </tr>
                  <tr>
                    <th>Property Owner(s)</th>
                    <td>
                      {{
                        applicationData.PropertyOwners.length > 0
                          ? getusers()
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Is Lien</th>
                    <td>
                      {{ applicationData.IsLien ? "Yes" : "No" }}
                    </td>
                  </tr>
                  <tr>
                    <th>Lien Person Name</th>
                    <td>
                      {{
                        applicationData.LienPersonName
                          ? applicationData.LienPersonName
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>Lien Date</th>
                    <td>
                      {{
                        applicationData.LienDate
                          ? (applicationData.LienDate | date: "dd-MM-yyyy")
                          : "-"
                      }}
                    </td>
                  </tr>
                  <tr>
                    <th>LienFrom</th>
                    <td>
                      {{
                        applicationData.LienFrom
                          ? applicationData.LienFrom
                          : "-"
                      }}
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </app-portlet>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <app-portlet
            loading="0"
            title="Upload Documents"
            color="light"
            collapsed="0"
            headerClass="title header-title "
            ><div>
              <app-upload-document [appid]="appID"></app-upload-document>
            </div>
          </app-portlet>
        </div>
      </div>
      <form
        [formGroup]="PVRForm"
        novalidate
        (ngSubmit)="save()"
        (keydown.enter)="$event.preventDefault()"
      >
        <!-- <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Encumbrance Information
        </h5>
        <hr />
        <div formArrayName="EncumbranceDetails" class="mb-3">
          <div
            *ngFor="
              let Encumbrance of PVRForm.controls.EncumbranceDetails[
                'controls'
              ];
              let i = index
            "
          >
            <div class="form-row" [formGroupName]="i">
              <div class="form-group col-md-6">
                <label>Loan Taken By</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="LoanTakenBy"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenBy.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanTakenBy
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenBy.errors.required
                    "
                  >
                    LoanTakenBy is Required
                  </div>
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenBy.errors.pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Loan Given By</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="LoanGivenBy"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanGivenBy.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanGivenBy
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanGivenBy.errors.required
                    "
                  >
                    LoanGivenBy is Required
                  </div>
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanGivenBy.errors.pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Loan Amount</label>
                <input
                  type="number"
                  class="form-control"
                  formControlName="LoanAmount"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls'].LoanAmount
                        .errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanAmount
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls'].LoanAmount
                        .errors.required
                    "
                  >
                    LoanAmount is Required
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Loan Taken On</label>
                <input
                  type="date"
                  class="form-control"
                  formControlName="LoanTakenOn"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenOn.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanTakenOn
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenOn.errors.required
                    "
                  >
                    LoanTakenOn is Required
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group col-md-12">
              <span
                class="mdi mdi-account-remove"
                style="cursor: pointer; color: red"
                *ngIf="
                  PVRForm.controls.EncumbranceDetails['controls'].length > 1
                "
                (click)="removeEncumbranceDetails(i)"
              >
              </span>
            </div>
            <hr />
          </div>
          <div class="">
            <a (click)="addEncumbranceDetails()" style="cursor: pointer">
              Add Another Encumbrance Detail
              <i class="mdi mdi-account-multiple-plus"></i>
            </a>
          </div>
        </div> -->
        <!-- <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Crop Information
        </h5>
        <hr />
        <div formArrayName="CropDetails" class="mb-3">
          <div
            *ngFor="
              let crop of PVRForm.controls.CropDetails['controls'];
              let i = index
            "
          >
            <div class="form-row" [formGroupName]="i">
              <div class="form-group col-md-6">
                <label>Season</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="Season"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Season.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Season.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Season.errors
                        .required
                    "
                  >
                    Season is Required
                  </div>
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Season.errors
                        .pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Crop</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="Crop"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Crop.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Crop.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Crop.errors
                        .required
                    "
                  >
                    Crop is Required
                  </div>
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Crop.errors
                        .pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Area</label>
                <input
                  type="number"
                  class="form-control"
                  formControlName="Area"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Area.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Area.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Area.errors
                        .required
                    "
                  >
                    Area is Required
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>MSP</label>
                <input
                  type="number"
                  class="form-control"
                  formControlName="MSP"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].MSP.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].MSP.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].MSP.errors
                        .required
                    "
                  >
                    MSP is Required
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Year</label>
                <input
                  type="date"
                  class="form-control"
                  formControlName="Year"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Year.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Year.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Year.errors
                        .required
                    "
                  >
                    Year is Required
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group col-md-12">
              <span
                class="mdi mdi-account-remove"
                style="cursor: pointer; color: red"
                *ngIf="PVRForm.controls.CropDetails['controls'].length > 1"
                (click)="removeCropDetails(i)"
              >
              </span>
            </div>
            <hr />
          </div>
          <div class="">
            <a (click)="addCropDetails()" style="cursor: pointer">
              Add Another Crop Detail
              <i class="mdi mdi-account-multiple-plus"></i>
            </a>
          </div>
        </div> -->
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Owner/CoOwners Information
        </h5>
        <hr />
        <div formArrayName="OwnerCoOwnersName" class="mb-3">
          <div>
            <div class="form-row">
              <div
                class="form-group col-md-6"
                *ngFor="
                  let Owner of PVRForm.controls.OwnerCoOwnersName['controls'];
                  let i = index
                "
                [formGroupName]="i"
              >
                <label>Owner Name*</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="OwnersName"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                        .errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                        .errors.required
                    "
                  >
                    Owners Name is Required
                  </div>
                  <div
                    *ngIf="
                      f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                        .errors.pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
                <div class="form-group col-md-6">
                  <span
                    class="mdi mdi-account-remove"
                    style="cursor: pointer; color: red"
                    *ngIf="
                      PVRForm.controls.OwnerCoOwnersName['controls'].length > 1
                    "
                    (click)="removeOwnerDetails(i)"
                  >
                  </span>
                </div>
              </div>
            </div>
            <hr />
          </div>
          <div class="">
            <a (click)="addOwnerDetails()" style="cursor: pointer">
              Add Another Owner Detail
              <i class="mdi mdi-account-multiple-plus"></i>
            </a>
          </div>
        </div>
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Property Status
        </h5>
        <hr />
        <div class="form-row">
          <div class="form-group col-md-4">
            <label>Total Land Size*</label>
            <input
              type="text"
              class="form-control"
              formControlName="TotalLandSize"
              maxlength="250"
              [ngClass]="{
                'is-invalid': submitted && f.TotalLandSize.errors
              }"
            />
            <div
              *ngIf="submitted && f.TotalLandSize.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.TotalLandSize.errors.required">
                Total Land Size is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-4">
            <label>iPVR Status*</label>
            <ng-select
              class="form-control"
              formControlName="PVRPropertyStatus"
              autocomplete="off"
              placeholder="
          Select iPVR Status"
              [ngClass]="{
                'is-invalid': submitted && f.PVRPropertyStatus.errors
              }"
            >
              <ng-option
                *ngFor="let item of PVRStatusList"
                [value]="item"
                [id]="item"
                >{{ item }}</ng-option
              >
            </ng-select>
            <div
              *ngIf="submitted && f.PVRPropertyStatus.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.PVRPropertyStatus.errors.required">
                iPVR Status is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-4">
            <label>Risk Meter*</label>
            <ng-select
              class="form-control"
              formControlName="PVRRiskMeterStatus"
              autocomplete="off"
              placeholder="
          Select Risk Meter"
              [ngClass]="{
                'is-invalid': submitted && f.PVRRiskMeterStatus.errors
              }"
            >
              <ng-option
                *ngFor="let item of PVRRiskMeterList"
                [value]="item"
                [id]="item"
                >{{ item }}</ng-option
              >
            </ng-select>
            <div
              *ngIf="submitted && f.PVRRiskMeterStatus.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.PVRRiskMeterStatus.errors.required">
                iPVR Risk Meter Status is Required
              </div>
            </div>
          </div>
        </div>
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Final Report
        </h5>
        <hr />
        <div class="form-row">
          <div class="form-group col-md-4">
            <label>Owner Remarks*</label>
            <textarea
              formControlName="OwnerRemarks"
              class="form-control"
              id="OwnerRemarks"
              [ngClass]="{
                'is-invalid': submitted && f.OwnerRemarks.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.OwnerRemarks.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.OwnerRemarks.errors.required">
                Owner Remarks is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-4">
            <label>Property Remarks*</label>
            <textarea
              formControlName="PropertyRemarks"
              class="form-control"
              id="PropertyRemarks"
              [ngClass]="{
                'is-invalid': submitted && f.PropertyRemarks.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.PropertyRemarks.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.PropertyRemarks.errors.required">
                Property Remarks is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-4">
            <label>Encumbrance Remarks*</label>
            <textarea
              formControlName="EncumbranceRemarks"
              class="form-control"
              id="EncumbranceRemarks"
              [ngClass]="{
                'is-invalid': submitted && f.EncumbranceRemarks.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.EncumbranceRemarks.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.EncumbranceRemarks.errors.required">
                Encumbrance Remarks is Required
              </div>
            </div>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label>Status Line 1*</label>
            <textarea
              formControlName="PVRStatusLine1"
              class="form-control"
              id="PVRStatusLine1"
              [ngClass]="{
                'is-invalid': submitted && f.PVRStatusLine1.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.PVRStatusLine1.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.PVRStatusLine1.errors.required">
                iPVR Status Line1 is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-6">
            <label>Status Line 2*</label>
            <textarea
              formControlName="PVRStatusLine2"
              class="form-control"
              id="PVRStatusLine2"
              [ngClass]="{
                'is-invalid': submitted && f.PVRStatusLine2.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.PVRStatusLine2.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.PVRStatusLine2.errors.required">
                iPVR Status Line2 is Required
              </div>
            </div>
          </div>
        </div>
        <div class="text-center mt-3">
          <button
            class="btn btn-primary waves-effect waves-light"
            type="button"
            data-toggle="collapse"
            data-target="#collapseExample"
            aria-expanded="true"
            aria-controls="collapseExample"
            type="submit"
          >
            Add iPVR
          </button>
        </div>
      </form>
    </div>
  </div>
  <div class="card-disabled" *ngIf="isLoading">
    <div class="card-portlets-loader"></div>
  </div>
</div>
