<div class="container-fluid pb-5">
  <!-- start page title -->
  <app-page-title
    title="PVR Report"
    [breadcrumbItems]="breadCrumbItems"
  ></app-page-title>
  <div class="card" *ngIf="!isLoading">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <!-- <app-portlet
            loading="0"
            title="Owner information"
            color="light"
            collapsed="0"
            headerClass="title header-title "
          >
          </app-portlet> -->
        </div>
      </div>
      <form
        [formGroup]="PVRForm"
        novalidate
        (ngSubmit)="save()"
        (keydown.enter)="$event.preventDefault()"
      >
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Encumbrance Information
        </h5>
        <hr />
        <div formArrayName="EncumbranceDetails" class="mb-3">
          <div
            *ngFor="
              let Encumbrance of PVRForm.controls.EncumbranceDetails[
                'controls'
              ];
              let i = index
            "
          >
            <div class="form-row" [formGroupName]="i">
              <div class="form-group col-md-6">
                <label>Loan Taken By*</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="LoanTakenBy"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenBy.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanTakenBy
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenBy.errors.required
                    "
                  >
                    LoanTakenBy is Required
                  </div>
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenBy.errors.pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Loan Given By*</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="LoanGivenBy"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanGivenBy.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanGivenBy
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanGivenBy.errors.required
                    "
                  >
                    LoanGivenBy is Required
                  </div>
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanGivenBy.errors.pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Loan Amount*</label>
                <input
                  type="number"
                  class="form-control"
                  formControlName="LoanAmount"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls'].LoanAmount
                        .errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanAmount
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls'].LoanAmount
                        .errors.required
                    "
                  >
                    LoanAmount is Required
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Loan Taken On*</label>
                <input
                  type="date"
                  class="form-control"
                  formControlName="LoanTakenOn"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenOn.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.EncumbranceDetails['controls'][i]['controls'].LoanTakenOn
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.EncumbranceDetails['controls'][i]['controls']
                        .LoanTakenOn.errors.required
                    "
                  >
                    LoanTakenOn is Required
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group col-md-12">
              <span
                class="mdi mdi-account-remove"
                style="cursor: pointer; color: red"
                *ngIf="
                  PVRForm.controls.EncumbranceDetails['controls'].length > 1
                "
                (click)="removeEncumbranceDetails(i)"
              >
              </span>
            </div>
            <hr />
          </div>
          <div class="">
            <a (click)="addEncumbranceDetails()" style="cursor: pointer">
              Add Another Encumbrance Detail
              <i class="mdi mdi-account-multiple-plus"></i>
            </a>
          </div>
        </div>
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Crop Information
        </h5>
        <hr />
        <div formArrayName="CropDetails" class="mb-3">
          <div
            *ngFor="
              let crop of PVRForm.controls.CropDetails['controls'];
              let i = index
            "
          >
            <div class="form-row" [formGroupName]="i">
              <div class="form-group col-md-6">
                <label>Season*</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="Season"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Season.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Season.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Season.errors
                        .required
                    "
                  >
                    Season is Required
                  </div>
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Season.errors
                        .pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Crop*</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="Crop"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Crop.errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Crop.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Crop.errors
                        .required
                    "
                  >
                    Crop is Required
                  </div>
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Crop.errors
                        .pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Area*</label>
                <input
                  type="number"
                  class="form-control"
                  formControlName="Area"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Area.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Area.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Area.errors
                        .required
                    "
                  >
                    Area is Required
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>MSP*</label>
                <input
                  type="number"
                  class="form-control"
                  formControlName="MSP"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].MSP.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].MSP.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].MSP.errors
                        .required
                    "
                  >
                    MSP is Required
                  </div>
                </div>
              </div>
              <div class="form-group col-md-6">
                <label>Year*</label>
                <input
                  type="date"
                  class="form-control"
                  formControlName="Year"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.CropDetails['controls'][i]['controls'].Year.errors
                  }"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.CropDetails['controls'][i]['controls'].Year.errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.CropDetails['controls'][i]['controls'].Year.errors
                        .required
                    "
                  >
                    Year is Required
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group col-md-12">
              <span
                class="mdi mdi-account-remove"
                style="cursor: pointer; color: red"
                *ngIf="PVRForm.controls.CropDetails['controls'].length > 1"
                (click)="removeCropDetails(i)"
              >
              </span>
            </div>
            <hr />
          </div>
          <div class="">
            <a (click)="addCropDetails()" style="cursor: pointer">
              Add Another Crop Detail
              <i class="mdi mdi-account-multiple-plus"></i>
            </a>
          </div>
        </div>
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          OwnerCoOwners Information
        </h5>
        <hr />
        <div formArrayName="OwnerCoOwnersName" class="mb-3">
          <div>
            <div class="form-row">
              <div
                class="form-group col-md-6"
                *ngFor="
                  let Owner of PVRForm.controls.OwnerCoOwnersName['controls'];
                  let i = index
                "
                [formGroupName]="i"
              >
                <label>Owner Name*</label>
                <input
                  type="text"
                  class="form-control"
                  formControlName="OwnersName"
                  maxlength="250"
                  [ngClass]="{
                    'is-invalid':
                      submitted &&
                      f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                        .errors
                  }"
                  pattern="[a-zA-Z][a-zA-Z- ]+"
                />
                <div
                  *ngIf="
                    submitted &&
                    f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                      .errors
                  "
                  class="invalid-feedback"
                >
                  <div
                    *ngIf="
                      f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                        .errors.required
                    "
                  >
                    OwnersName is Required
                  </div>
                  <div
                    *ngIf="
                      f.OwnerCoOwnersName['controls'][i]['controls'].OwnersName
                        .errors.pattern
                    "
                  >
                    Only Alpha letters Allowed
                  </div>
                </div>
                <div class="form-group col-md-6">
                  <span
                    class="mdi mdi-account-remove"
                    style="cursor: pointer; color: red"
                    *ngIf="
                      PVRForm.controls.OwnerCoOwnersName['controls'].length > 1
                    "
                    (click)="removeOwnerDetails(i)"
                  >
                  </span>
                </div>
              </div>
            </div>
            <hr />
          </div>
          <div class="">
            <a (click)="addOwnerDetails()" style="cursor: pointer">
              Add Another Owner Detail
              <i class="mdi mdi-account-multiple-plus"></i>
            </a>
          </div>
        </div>
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Property Status
        </h5>
        <hr />
        <div class="form-row">
          <div class="form-group col-md-6">
            <label>Total Land Size*</label>
            <input
              type="text"
              class="form-control"
              formControlName="TotalLandSize"
              maxlength="250"
              [ngClass]="{
                'is-invalid': submitted && f.TotalLandSize.errors
              }"
            />
            <div
              *ngIf="submitted && f.TotalLandSize.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.TotalLandSize.errors.required">
                TotalLandSize is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-6">
            <label>PVR Status*</label>
            <ng-select
              class="form-control"
              formControlName="PVRStatus"
              autocomplete="off"
              placeholder="
          Select Status"
              [ngClass]="{
                'is-invalid': submitted && f.PVRStatus.errors
              }"
            >
              <ng-option
                *ngFor="let item of PVRStatusList"
                [value]="item"
                [id]="item"
                >{{ item }}</ng-option
              >
            </ng-select>
            <div
              *ngIf="submitted && f.PVRStatus.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.PVRStatus.errors.required">
                PVRStatus is Required
              </div>
            </div>
          </div>
        </div>
        <h5
          class="header-title mb-0"
          style="color: rgb(34, 30, 30); font-size: 18px"
        >
          Final Report
        </h5>
        <hr />
        <div class="form-row">
          <div class="form-group col-md-4">
            <label>Owner Remarks*</label>
            <textarea
              formControlName="OwnerRemarks"
              class="form-control"
              id="OwnerRemarks"
              [ngClass]="{
                'is-invalid': submitted && f.OwnerRemarks.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.OwnerRemarks.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.OwnerRemarks.errors.required">
                OwnerRemarks is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-4">
            <label>Property Remarks*</label>
            <textarea
              formControlName="PropertyRemarks"
              class="form-control"
              id="PropertyRemarks"
              [ngClass]="{
                'is-invalid': submitted && f.PropertyRemarks.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.PropertyRemarks.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.PropertyRemarks.errors.required">
                PropertyRemarks is Required
              </div>
            </div>
          </div>
          <div class="form-group col-md-4">
            <label>Encumbrance Remarks*</label>
            <textarea
              formControlName="EncumbranceRemarks"
              class="form-control"
              id="EncumbranceRemarks"
              [ngClass]="{
                'is-invalid': submitted && f.EncumbranceRemarks.errors
              }"
              cols="30"
              rows="5"
            ></textarea>

            <div
              *ngIf="submitted && f.EncumbranceRemarks.errors"
              class="invalid-feedback"
            >
              <div *ngIf="f.EncumbranceRemarks.errors.required">
                PropertyRemarks is Required
              </div>
            </div>
          </div>
        </div>
        <div class="text-center mt-3">
          <button
            class="btn btn-primary waves-effect waves-light"
            type="button"
            data-toggle="collapse"
            data-target="#collapseExample"
            aria-expanded="true"
            aria-controls="collapseExample"
            type="submit"
          >
            Add PVR
          </button>
        </div>
      </form>
    </div>
  </div>
  <div class="card-disabled" *ngIf="isLoading">
    <div class="card-portlets-loader"></div>
  </div>
</div>
